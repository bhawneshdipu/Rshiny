{
    "collab_server" : "",
    "contents" : "## Preprocessing ##\n\n\n#====================Preprocesing===============================\n\nfunction.MyPreprocessing<-function(data1) {\n  #browser()\n  \n  #chnge format of Date\n  data1$Date_Time <- data1$Date\n  data1$Date_Time <-do.call(paste, c(data1[c(\"Date_Time\", \"Time\")], sep = \"\"))\n  data1$Date_Time <- as.POSIXct(data1$Date_Time, format = \"%d%m%y%H%M\")\n  #data1$Date_Time <- as.Date(data1$Date_Time, \"%d%m%y%H%M\")\n  data1$Date <- as.POSIXct(data1$Date,format = \"%d%m%y\")\n  data1$Date <- as.Date(data1$Date,format = \"%d%m%y\")\n  \n  data1 <- data1[, c(ncol(data1), 1:(ncol(data1) - 1))]\n  \n  #Add \":\" in time\n  data1$Time <- sub(\"(.{2})(.*)\", \"\\\\1:\\\\2\", data1$Time)\n  \n  #Necessarily Columns as.factor\n  data1$CHANNEL <- as.numeric(data1$CHANNEL)\n  data1$LOCATION <- as.factor(data1$LOCATION)\n  data1$SITE <- as.factor(data1$SITE)\n  data1$FILENAME <- as.factor(data1$FILENAME)\n  data1$INSTRUMENT <- as.factor(data1$INSTRUMENT)\n  data1$HEADINGS <- as.factor(data1$HEADINGS)\n  #data1$Time <- as.numeric(data1$Time)\n  #set measured data as numeric\n  data1$SP1 = as.numeric(data1$SP1)\n  data1$SP2 = as.numeric(data1$SP2)\n  data1$SP3 = as.numeric(data1$SP3)\n  data1$SP4 = as.numeric(data1$SP4)\n  data1$SP5 = as.numeric(data1$SP5)\n  data1$SP6 = as.numeric(data1$SP6)\n  data1$SP7 = as.numeric(data1$SP7)\n  data1$SP8 = as.numeric(data1$SP8)\n  data1$SP9 = as.numeric(data1$SP9)\n  data1$SP10 = as.numeric(data1$SP10)\n  data1$SP11 = as.numeric(data1$SP11)\n  data1$SP12 = as.numeric(data1$SP12)\n  data1$SP13 = as.numeric(data1$SP13)\n  data1$SP14 = as.numeric(data1$SP14)\n  \n  data1$LN1 = as.numeric(data1$LN1)\n  data1$LN2 = as.numeric(data1$LN2)\n  data1$LN3 = as.numeric(data1$LN3)\n  data1$LN4 = as.numeric(data1$LN4)\n  data1$LN5 = as.numeric(data1$LN5)\n  data1$LN6 = as.numeric(data1$LN6)\n  data1$LN7 = as.numeric(data1$LN7)\n  data1$LN8 = as.numeric(data1$LN8)\n  data1$LN9 = as.numeric(data1$LN9)\n  \n  data1$CS1 = as.numeric(data1$CS1)\n  data1$CS2 = as.numeric(data1$CS2)\n  data1$CS3 = as.numeric(data1$CS3)\n  data1$CS4 = as.numeric(data1$CS4)\n  data1$CS5 = as.numeric(data1$CS5)\n  data1$CS6 = as.numeric(data1$CS6)\n  \n  \n  #add column sum of cars in interval\n  data1$SUM <- rowSums(data1[, 5:18])\n  \n  \n   \n  dipu.pre_data<<-data1\n  #browser()\n  data1\n  \n}\n\nfunction.MyFilter<-function(data1,filename,daterange,channel){\n  #browser()\n  # filter by FILENAME\n  if (filename == \"all\") {\n    data1<-data1\n  } else{\n    data1 <- data1 %>% filter(FILENAME == paste0(filename, \"_MEJA\"))\n  }\n  \n  #=====================DATE PREPROCESSING=============================\n  # data1$Date_Time <- data1$Date\n  # data1$Date_Time <- do.call(paste,c(data1[c(\"Date_Time\",\"Time\")],sep = \"\"))\n  # data1$Date_Time <- as.POSIXct(data1$Date_Time,format = \"%d%m%y%H%M\")\n  # data1$Date_Time <- as.Date(data1$Date_Time, \"%d%m%y%H%M\")\n  # data1$Date <- as.POSIXct(data1$Date,format = \"%d%m%y\")\n  # data1<-data1[,c(ncol(data1),1:(ncol(data1)-1))]\n  \n  #browser()\n  #View(daterange)\n  message(daterange)\n  tryCatch({\n    #filter by date\n    fromdate<-as.Date(daterange[1],\"%Y-%m-%d\")\n    todate<-as.Date(daterange[2],\"%Y-%m-%d\")\n    message(todate)\n    message(fromdate)\n    data1<-data1[data1$Date>=fromdate & data1$Date<=todate,]\n    \n  },error=function(cond){\n    message(\"Date Range is not defined til now:\")\n  })\n  \n  #browser()\n  #filter by channel\n  if (channel == \"all\") {\n    data1<-data1\n  }else if(channel == \"12\"){\n    data1 <- data1  %>% filter(CHANNEL %in%  c(\"1\",\"2\"))\n  }else if(channel == \"34\"){\n    data1 <- data1 %>% filter(CHANNEL %in%  c(\"3\",\"4\"))\n  }else if(channel == \"1\"){\n    data1 <- data1 %>% filter(CHANNEL == \"1\")\n  }else if(channel == \"2\"){\n    data1 <- data1 %>% filter(CHANNEL==\"2\")\n  }else if(channel == \"3\"){\n    data1 <- data1 %>% filter(CHANNEL == \"3\")\n  }else if(channel == \"4\"){\n    data1 <- data1 %>% filter(CHANNEL == \"4\")\n  }else{\n    data1<-data1\n  }\n  #browser()\n  #unfinished preparation I will explain what I need\n  splitH <- str_split_fixed(data1$HEADINGS, \" \", 4)\n  splitH <- as.data.frame(splitH)\n  #splitH <- unique(splitH)\n  data1$CHANNEL<-gsub(\"1\", paste0(\"1_\",splitH[1,1]), data1$CHANNEL)\n  data1$CHANNEL<-gsub(\"2\", paste0(\"2_\",splitH[2,1]), data1$CHANNEL)\n  data1$CHANNEL<-gsub(\"3\", paste0(\"3_\",splitH[3,1]), data1$CHANNEL)\n  data1$CHANNEL<-gsub(\"4\", paste0(\"4_\",splitH[4,1]), data1$CHANNEL)\n  \n  data1$CHANNEL = as.factor(data1$CHANNEL)\n  data1$Time = as.factor(data1$Time)\n  dipu.fil_data<<-data1\n  #browser()\n  data1\n}\n",
    "created" : 1522870129625.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1376056536",
    "id" : "E721F515",
    "lastKnownWriteTime" : 1522947168,
    "last_content_update" : 1522947168360,
    "path" : "~/fiverr/Rshiny/Preprocessing.R",
    "project_path" : "Preprocessing.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 8,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}